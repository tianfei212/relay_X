# JOJO-Relay-X 网关测试程序

这是一个用于测试 JOJO-Relay-X 网关的客户端测试程序，用于验证网关与前端客户端之间的连接和通信。

## 功能特性

- 模拟前端客户端连接到网关
- 执行身份验证和注册过程
- 发送心跳消息维持连接
- 接收并统计网关发送的各种消息类型
- 支持单个连接测试和压力测试
- 模拟视频数据传输场景

## 测试文件

- `test_client.go`: 主测试程序源码
- `IMG_4127.MOV`: 用于测试的视频文件

## 使用方法

### 单个连接测试

```bash
# 在 client_test 目录下运行
go run test_client.go
```

### 压力测试（100个客户端）

```bash
# 在 client_test 目录下运行
go run test_client.go load
```

## 测试结果说明

- **成功连接**: 客户端成功连接到网关并完成身份验证
- **连接限制**: 当达到网关配置的最大连接数（默认为2个前端连接）时，新连接会被拒绝
- **消息类型**:
  - `pong`: 心跳响应消息
  - `log`: 日志推送消息
  - `telemetry`: 遥测数据（带宽速度等）
  - `port_alloc`: 端口分配消息
  - `key_exchange`: 密钥交换消息

## 配置说明

根据 `configs/config.yaml` 文件配置：
- `max_fe`: 最大前端连接数（默认为2）
- `max_be`: 最大后端连接数（默认为2）
- `auth_secret`: 认证密钥（默认为 "dummy_secret"）

## 测试覆盖

- TCP连接建立
- JSON消息协议验证
- 身份验证流程
- 心跳维持机制
- 消息接收处理
- 连接数限制验证
- 并发连接处理